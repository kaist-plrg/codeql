\section{Introduction}
Declarative style analysis has become one of widely used analysis techniques.
Declarative style analyzers detect possible bugs and
security vulnerabilities by 1) transforming program source code to "database"
of "facts", 2) generating new facts from the known facts via applying
"rules", and 3) extracting all facts related to specific properties by
applying the rules to the facts via "query system".  DOOP[??] is a
declarative style analysis framework conducting points-to analysis for Java
programs, and CodeQL[??] is a declarative semantic code analysis engine
maintained by Github, which performs data-flow analysis to detect security
vulnerabilities in Java programs.  Recently, Glean[??], an experimental
declarative query system, has been developed by Meta, on which users can query
information about code structures for JavaScript and Hack programs.

Declarative style analyzers broaden their analysis targets to
diverse programming languages. Because the query system is independent of
analysis target languages, only required extensions for an additional target
language support include a new schema of the database containing facts,
new language-specific rules, and a front-end transforming programs written in the
target language to facts. With the extensions, declarative analyzers can
analyze various properties in programs written in the new target language,
using a sequence of queries and the query system.  DOOP currently supports
Python program analysis to detect tensor shape mismatching bugs in TensorFlow
based Python ML models[??]. CodeQL was originally desinged for Java programs,
and now it can track data-flows not only in Java but also in C++, C\#, JavaScript,
Ruby, Python, and \inred{Swift} programs.  Furthermore, Glean has a plan to support
diverse target programming languages including Python, Java, C++, Rust, and
Haskell.

While the analyzers target multiple programming languages, they do not directly
support the analysis of multilingual programs written in two or more programming
languages. Multilingual programs have been widely developed in various
application domains[5, 8]. However, multilingual programs are often vulnerable
to bugs or security issues more than monolingual programs. A large-scale study
on the code quality of multilingual programs[6] reported that using multiple
languages together correlates with higher error-proneness. Moreover, [7] showed
that two or three times more bugs and security issues had been reported on the
language interoperation than on the intraoperation in widely-used open-source
JNI programs such as OpenJ9 and VLC.

In this paper, we propose a systematic engineering methodology that extends a
declarative style analyzer supporting multiple target languages to support
multilingual program analysis as well. Our approach first generates a merged
database of facts that can be separated into multiple logical language spaces.
Each language space consists of original facts from corresponding
language database, and existing language-specific rules derive new facts from
facts in the corresponding language space. Then, in order to handle language
interoperation in multilingual programs, we define language-interoperation
rules referring to language interoperation semantics. The
language-interoperation rules derive new facts from facts across language
spaces. The extensions enable the query system to extract facts in multilingual
programs, considering language interoperation.

To evaluate the practicality of our approach, we develop a proof-of-concept
declarative style analyzer for multilingual programs by extending CodeQL. Our
analyzer tracks data-flows across language boundaries for two types of
multilingual programs: Java-C programs written in both Java and C, and Python-C
programs written in both Python and C. The extension is simple enough in that
it requires only a few lines of automated modifications of CodeQL and additional
language-interpretation rules. We also implement a bug checker on the top of
the analyzer to detect data-flow related interoperation bugs in real world Java-C programs.
In our evaluation, we show that our tool successfully tracked data-flows across
Java-C and Python-C language boundaries and detected genuine interoperation
bugs in real-world multilingual programs.

The contributions of this paper are as followed:
\begin{itemize}
\item We propose an engineering method that extends a declarative style analyzer
supporting multiple target languages to support multilingual program analysis.

\item We implement a proof-of-concept declarative style data-flow analyzer for two
types of multilingual programs, Java-C and Python-C, by extending CodeQL.

\item We show the practical usefulness of our analyzer in the sense that it detects
data-flow related bugs at language boundaries of real-world multilingual
programs.
\end{itemize}
